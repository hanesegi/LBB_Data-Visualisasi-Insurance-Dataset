knitr::opts_chunk$set(echo = TRUE)
df = read.csv('data_input\insurance.csv', header = TRUE)
df = read.csv('data_input\insurance.csv', header = TRUE)
df = read.csv('data_input/insurance.csv', header = TRUE)
head(df)
summary(df)
str(df)
##Check missing Value
colSums(is.na(df))
##check duplikat data
sum(duplicated(df))
##check duplikat data
sum(duplicated(df))
##check duplikat data
```{r}
library(tidyverse)
library(ggplot2)
y <- ggplot(df, aes(bmi, charges)) +
geom_jitter(color = "green", alpha = 0.5) +
theme_light()
title <- ggdraw() + draw_label("1. Correlation between Charges and Age / BMI", fontface='bold')
install.packages("ggdraw")
ggplot(df,aes(x = Charges, color = Smoking))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
ggplot(df,aes(x = charges, color = smoking))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
ggplot(df,aes(x = charges, color = smoker))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
data[duplicated(df),]
df[duplicated(df),]
```{r}
cat("check duplikat",sum(duplicated(df)) , "duplicated rows.\n")
cat("check duplikat...",sum(duplicated(df)) , "ada .\n")
cat("jumlah data duplikat.",sum(duplicated(df)))
cat("\nThe duplicated row is:")
df[duplicated(df),]
cat("\nThe duplicated row is:")
df[duplicated(df),]
cat("\data duplikatnya")
")
df[duplicated(df),]
cat("\data duplikatnya")
nThe duplicated row is:
cat("\nThe duplicated row is:")
df[duplicated(df),]
df <- df %>% distinct()
ggplot(df, aes(x=log(charges))) +
geom_histogram(aes(y=..density..),color="black", fill="pink", bins=40) +
geom_density(color="blue") +
geom_vline(aes(xintercept= mean(log(charges))), color="blue", linetype="dashed", size=1) +
geom_vline(aes(xintercept= median(log(charges))), color="red", linetype="dashed", size=1)
df <- df %>%
mutate(bmi_cat = case_when(
bmi < 18.5 ~ "underweight",
bmi < 25 ~ "healthy weight",
bmi < 30 ~ "overweight",
bmi >= 30 ~ "obesity"
))
head(df)
avg_charges_all %>%
ggplot(aes(x = bmi_cat, y = avg_charges, fill = smoker)) +
geom_col(position = "dodge") +
labs(title = "Average Charges v BMI Category",
x = "BMI Category",
y = "Average Charges ($)")
bg+geom_bar(fill = "blue")
geom_bar(fill = "blue")
ggplot(df)+
geom_violin(mapping = aes(x = Smoking, y = Charges, fill = Gender), draw_quantiles = (c(0.25,0.5,0.75)))
ggplot(df)+
geom_violin(mapping = aes(x = smoker, y = charges, fill = Gender), draw_quantiles = (c(0.25,0.5,0.75)))
ggplot(df)+
geom_violin(mapping = aes(x = smoker, y = charges, fill = Gender), draw_quantiles = (c(0.25,0.5,0.75)))
ggplot(df)+
geom_violin(mapping = aes(x = smoker, y = charges, fill = gender), draw_quantiles = (c(0.25,0.5,0.75)))
ggplot(df)+
geom_violin(mapping = aes(x = smoker, y = charges, fill = sex), draw_quantiles = (c(0.25,0.5,0.75)))
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
install.packages("knitr")
knitr::opts_chunk$set(echo = TRUE)
ggplot(df,aes(x = charges, color = smoker))+
geom_histogram(fill = "red", position = "dodge")+
theme(legend.position = "top")
ggplot(df,aes(x = charges))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
ggplot(df,aes(x = charges, color = smoker))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
ggplot(df,aes(x = charges, color = smoker))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
library(Hmisc)
library(tidyverse)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE)
ggplot(df,aes(x = charges, color = smoker))+
geom_histogram(fill = "white", position = "dodge")+
theme(legend.position = "top")
